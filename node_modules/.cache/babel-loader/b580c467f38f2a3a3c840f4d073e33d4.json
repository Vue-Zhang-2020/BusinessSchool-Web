{"remainingRequest":"D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\node_modules\\babel-loader\\lib\\index.js!D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\src\\store\\modules\\user.js","dependencies":[{"path":"D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\src\\store\\modules\\user.js","mtime":1594437428838},{"path":"D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:/\\u4E2A\\u4EBA\\u6210\\u957F\\u7ECF\\u5386/\\u9510\\u540D\\u79D1\\u6280/\\u4EA7\\u54C1\\u5F00\\u53D1/\\u5546\\u7BA1\\u9662/BusinessSchool-Web/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _login = require(\"@/api/login\");\n\nvar _auth = require(\"@/utils/auth\");\n\nvar _zRouter = _interopRequireDefault(require(\"@/utils/z-router\"));\n\nvar _router = require(\"@/router\");\n\nvar user = {\n  state: {\n    token: (0, _auth.getToken)(),\n    name: '',\n    avatar: '',\n    schoolId: '',\n    roles: [],\n    routers: _router.constantRoutes,\n    addRouters: [],\n    tRouters: _router.constantRoutes,\n    addTRouters: [],\n    pathRouter: ''\n  },\n  mutations: {\n    SET_TOKEN: function SET_TOKEN(state, token) {\n      state.token = token;\n    },\n    SET_NAME: function SET_NAME(state, name) {\n      state.name = name;\n    },\n    SET_AVATAR: function SET_AVATAR(state, avatar) {\n      state.avatar = avatar;\n    },\n    SET_SCHOOL_ID: function SET_SCHOOL_ID(state, schoolId) {\n      state.schoolId = schoolId;\n    },\n    SET_ROLES: function SET_ROLES(state, roles) {\n      state.roles = roles;\n    },\n    SET_ROUTERS: function SET_ROUTERS(state, routers) {\n      state.addRouters = routers; //路由访问\n\n      state.routers = _router.constantRoutes.concat(routers).concat(_router.notFoundRouter); //菜单显示,404最后加入\n    },\n    SET_T_ROUTERS: function SET_T_ROUTERS(state, routers) {\n      state.tRouters = _router.constantRoutes.concat(routers).concat(_router.notFoundRouter); //菜单显示,404最后加入\n    },\n    SET_PATH_ROUTER: function SET_PATH_ROUTER(state, paths) {\n      state.pathRouter = paths;\n    },\n    LOGOUT: function LOGOUT(state) {\n      state.addRouters = [];\n      state.routers = [];\n      state.tRouters = [], state.addTRouters = [], state.name = '';\n      state.roles = [];\n      state.token = '';\n      state.pathRouter = '';\n    }\n  },\n  actions: {\n    // 登录\n    Login: function Login(_ref, userInfo) {\n      var commit = _ref.commit;\n      var username = userInfo.username.trim();\n      return new Promise(function (resolve, reject) {\n        (0, _login.login)(username, userInfo.password).then(function (response) {\n          var data = response.data;\n          (0, _auth.setToken)(data[0].api_token);\n          commit('SET_TOKEN', data[0].api_token);\n          resolve(response);\n        }).catch(function (error) {\n          reject('错误' + error);\n        });\n      });\n    },\n    // 获取用户信息\n    GetInfo: function GetInfo(_ref2) {\n      var commit = _ref2.commit,\n          state = _ref2.state;\n      return new Promise(function (resolve, reject) {\n        (0, _login.getInfo)(state.token).then(function (response) {\n          var data = response.data;\n          commit('SET_NAME', '张三');\n          commit('SET_ROLES', 'data.roles');\n          commit('SET_AVATAR', 'data.avatar');\n          commit('SET_SCHOOL_ID', '1');\n          commit('SET_ROUTERS', (0, _zRouter.default)(data[0]));\n          resolve(response);\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    GetInfoss: function GetInfoss(_ref3) {\n      var commit = _ref3.commit,\n          state = _ref3.state;\n      return new Promise(function (resolve, reject) {\n        // getInfo(state.token).then(response => {\n        var json = {\n          \"router\": [{\n            \"path\": \"/school\",\n            \"component\": \"Layout\",\n            \"meta\": {\n              \"title\": \"学校管理\",\n              \"icon\": \"school\"\n            },\n            \"children\": [{\n              \"path\": \"info\",\n              \"name\": \"info\",\n              \"component\": \"school_port/school/school_info\",\n              \"meta\": {\n                \"title\": \"学校信息\"\n              }\n            }, {\n              \"path\": \"major\",\n              \"name\": \"major\",\n              \"component\": \"school_port/school/school_major_manager\",\n              \"meta\": {\n                \"title\": \"学校专业管理\"\n              }\n            }, {\n              \"path\": \"class\",\n              \"name\": \"class\",\n              \"component\": \"school_port/school/school_class_manager\",\n              \"meta\": {\n                \"title\": \"学校班级管理\"\n              }\n            }]\n          }, {\n            \"path\": \"/student\",\n            \"component\": \"Layout\",\n            \"meta\": {\n              \"title\": \"学生资料\",\n              \"icon\": \"plane\"\n            },\n            \"children\": [{\n              \"path\": \"info\",\n              \"name\": \"info\",\n              \"component\": \"school_port/student/student_info_manager\",\n              \"meta\": {\n                \"title\": \"学生资料管理\"\n              }\n            }, {\n              \"path\": \"grade\",\n              \"name\": \"grade\",\n              \"component\": \"school_port/student/student_grade_manager\",\n              \"meta\": {\n                \"title\": \"学生成绩列表\"\n              }\n            }]\n          }, {\n            \"path\": \"/campus\",\n            \"component\": \"Layout\",\n            \"meta\": {\n              \"title\": \"校园头条中心\",\n              \"icon\": \"plane\"\n            },\n            \"children\": [{\n              \"path\": \"head\",\n              \"name\": \"head\",\n              \"component\": \"school_port/campus/campus_head_center\",\n              \"meta\": {\n                \"title\": \"校园头条中心\"\n              }\n            }]\n          }, {\n            \"path\": \"/dynamic\",\n            \"component\": \"Layout\",\n            \"meta\": {\n              \"title\": \"动态中心\",\n              \"icon\": \"plane\"\n            },\n            \"children\": [{\n              \"path\": \"center\",\n              \"name\": \"center\",\n              \"component\": \"school_port/dynamic/dynamic_center\",\n              \"meta\": {\n                \"title\": \"动态中心\"\n              }\n            }]\n          }]\n        };\n        var json2 = {\n          \"router\": [{\n            \"path\": \"/firm\",\n            \"component\": \"Layout\",\n            \"meta\": {\n              \"title\": \"教学计划\",\n              \"icon\": \"plane\"\n            },\n            \"children\": [{\n              \"path\": \"program\",\n              \"name\": \"program\",\n              \"component\": \"firm_port/teaching_plan_view\",\n              \"meta\": {\n                \"title\": \"教学计划查看\"\n              }\n            }]\n          }]\n        };\n        var json3 = {\n          \"router\": [{\n            \"path\": \"/home\",\n            \"component\": \"Layout\",\n            \"redirect\": \"/home/home\",\n            \"meta\": {\n              \"title\": \"首页\",\n              \"icon\": \"plane\"\n            },\n            \"children\": [{\n              \"path\": \"/home/home\",\n              \"component\": \"business_port/home/home\",\n              \"meta\": {\n                \"title\": \"\",\n                \"icon\": \"\"\n              }\n            }]\n          }, {\n            \"path\": \"/teaching\",\n            \"component\": \"Layout\",\n            \"redirect\": \"/teaching/plan\",\n            \"meta\": {\n              \"title\": \"教学管理\",\n              \"icon\": \"plane\"\n            },\n            \"children\": [{\n              \"path\": \"/teaching/plan\",\n              \"component\": \"RouterView\",\n              \"redirect\": \"/teaching/plan/enact\",\n              \"meta\": {\n                \"title\": \"教学计划管理\",\n                \"icon\": \"plane\"\n              },\n              \"children\": [{\n                \"path\": \"/teaching/plan/list\",\n                \"name\": \"list\",\n                \"component\": \"business_port/teaching/teaching_plan/teaching_plan_list\",\n                \"meta\": {\n                  \"title\": \"教学计划列表\"\n                }\n              }, {\n                \"path\": \"/teaching/plan/enact\",\n                \"name\": \"enact\",\n                \"component\": \"business_port/teaching/teaching_plan/teaching_enact_plan\",\n                \"meta\": {\n                  \"title\": \"制定教学计划\"\n                }\n              }, {\n                \"path\": \"/teaching/plan/medal\",\n                \"name\": \"medal\",\n                \"component\": \"business_port/teaching/teaching_plan/teaching_medal_manager\",\n                \"meta\": {\n                  \"title\": \"勋章管理\"\n                }\n              }]\n            }, {\n              \"path\": \"/teaching/course\",\n              \"component\": \"RouterView\",\n              \"redirect\": \"/teaching/course/center\",\n              \"meta\": {\n                \"title\": \"课程管理\",\n                \"icon\": \"plane\"\n              },\n              \"children\": [{\n                \"path\": \"/teaching/course/center\",\n                \"name\": \"center\",\n                \"component\": \"business_port/teaching/course_manager/course_center\",\n                \"meta\": {\n                  \"title\": \"课程中心\"\n                }\n              }, {\n                \"path\": \"/teaching/course/type\",\n                \"name\": \"type\",\n                \"component\": \"business_port/teaching/course_manager/course_type\",\n                \"meta\": {\n                  \"title\": \"课程分类\"\n                }\n              }]\n            }, {\n              \"path\": \"/teaching/exam\",\n              \"component\": \"RouterView\",\n              \"redirect\": \"/teaching/exam/center\",\n              \"meta\": {\n                \"title\": \"考试管理\",\n                \"icon\": \"plane\"\n              },\n              \"children\": [{\n                \"path\": \"/teaching/exam/center\",\n                \"name\": \"center\",\n                \"component\": \"business_port/teaching/exam_manager/exam_center\",\n                \"meta\": {\n                  \"title\": \"考试中心\"\n                }\n              }]\n            }]\n          }, {\n            \"path\": \"/student\",\n            \"component\": \"Layout\",\n            \"redirect\": \"/student/attend\",\n            \"meta\": {\n              \"title\": \"学生资料\",\n              \"icon\": \"plane\"\n            },\n            \"children\": [{\n              \"path\": \"/student/attend\",\n              \"component\": \"RouterView\",\n              \"redirect\": \"/student/attend/plan\",\n              \"meta\": {\n                \"title\": \"学生上课资料\",\n                \"icon\": \"plane\"\n              },\n              \"children\": [{\n                \"path\": \"/student/attend/plan\",\n                \"name\": \"plan\",\n                \"component\": \"business_port/teaching/teaching_plan/teaching_medal_manager\",\n                \"meta\": {\n                  \"title\": \"学生教学计划\"\n                }\n              }, {\n                \"path\": \"/student/attend/asd\",\n                \"name\": \"asd\",\n                \"component\": \"business_port/teaching/teaching_plan/teaching_medal_manager\",\n                \"meta\": {\n                  \"title\": \"学生签到\"\n                }\n              }, {\n                \"path\": \"/student/attend/aaa\",\n                \"name\": \"aaa\",\n                \"component\": \"business_port/teaching/teaching_plan/teaching_medal_manager\",\n                \"meta\": {\n                  \"title\": \"学生成绩列表\"\n                }\n              }, {\n                \"path\": \"/student/attend/asc\",\n                \"name\": \"asc\",\n                \"component\": \"business_port/teaching/teaching_plan/teaching_medal_manager\",\n                \"meta\": {\n                  \"title\": \"学生积分余额\"\n                }\n              }]\n            }, {\n              \"path\": \"/student/roll\",\n              \"component\": \"business_port/teaching/teaching_plan/teaching_medal_manager\",\n              \"redirect\": \"/student/roll/manager\",\n              \"meta\": {\n                \"title\": \"学生学籍资料\",\n                \"icon\": \"plane\"\n              },\n              \"children\": [{\n                \"path\": \"/student/roll/manager\",\n                \"name\": \"manager\",\n                \"component\": \"business_port/teaching/teaching_plan/teaching_medal_manager\",\n                \"meta\": {\n                  \"title\": \"学生学籍管理\"\n                }\n              }]\n            }]\n          }, {\n            \"path\": \"/unit\",\n            \"component\": \"Layout\",\n            \"redirect\": \"/unit/firm\",\n            \"meta\": {\n              \"title\": \"合作单位\",\n              \"icon\": \"plane\"\n            },\n            \"children\": [{\n              \"path\": \"/unit/firm\",\n              \"component\": \"RouterView\",\n              \"redirect\": \"/unit/firm/coop\",\n              \"meta\": {\n                \"title\": \"企业单位管理\",\n                \"icon\": \"plane\"\n              },\n              \"children\": [{\n                \"path\": \"/unit/firm/coop\",\n                \"name\": \"coop\",\n                \"component\": \"business_port/unit/cooperator_unit\",\n                \"meta\": {\n                  \"title\": \"合作企业列表\"\n                }\n              }, {\n                \"path\": \"/unit/firm/school\",\n                \"name\": \"school\",\n                \"component\": \"business_port/unit/cooperator_school\",\n                \"meta\": {\n                  \"title\": \"合作学校列表\"\n                }\n              }]\n            }]\n          }, {\n            \"path\": \"/bus\",\n            \"component\": \"Layout\",\n            \"meta\": {\n              \"title\": \"商管院管理\",\n              \"icon\": \"plane\"\n            }\n          }, {\n            \"path\": \"/system\",\n            \"component\": \"Layout\",\n            \"meta\": {\n              \"title\": \"系统设置\",\n              \"icon\": \"plane\"\n            }\n          }]\n        }; // let tRouters = []\n        // json3.router.forEach(element => {\n        //   if (element.children) {  \n        //     tRouters.push(...element.children)\n        //   }\n        // });\n        // console.log(tRouters)\n        // const data = response.data\n\n        commit('SET_NAME', 'data.name');\n        commit('SET_ROLES', sessionStorage.getItem('roles'));\n        commit('SET_AVATAR', 'data.avatar');\n        commit('SET_SCHOOL_ID', 1); // commit('SET_ROUTERS', routerFormat(data.routers))\n\n        console.log(sessionStorage.getItem('roles'));\n        commit('SET_ROUTERS', (0, _zRouter.default)(sessionStorage.getItem('roles') === '1' ? json.router : sessionStorage.getItem('roles') === '2' ? json3.router : json2.router)); // commit('SET_T_ROUTERS', tRouters)\n\n        resolve(); // }).catch(error => {\n        //   reject(error)\n        // })\n      });\n    },\n    // 登出\n    LogOut: function LogOut(_ref4) {\n      var commit = _ref4.commit,\n          state = _ref4.state;\n      return new Promise(function (resolve, reject) {\n        (0, _login.logout)(state.token).then(function () {\n          commit('LOGOUT', '');\n          (0, _auth.removeToken)();\n          resolve();\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    // 前端 登出\n    FedLogOut: function FedLogOut(_ref5) {\n      var commit = _ref5.commit;\n      return new Promise(function (resolve) {\n        commit('LOGOUT', '');\n        (0, _auth.removeToken)();\n        resolve();\n      });\n    }\n  }\n};\nvar _default = user;\nexports.default = _default;",null]}