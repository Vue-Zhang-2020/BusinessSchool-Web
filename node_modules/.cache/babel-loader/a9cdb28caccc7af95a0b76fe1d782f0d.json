{"remainingRequest":"D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\node_modules\\babel-loader\\lib\\index.js!D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\src\\views\\business_port\\teaching\\teaching_plan\\teaching_enact_plan.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\src\\views\\business_port\\teaching\\teaching_plan\\teaching_enact_plan.vue","mtime":1594612519731},{"path":"D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\个人成长经历\\锐名科技\\产品开发\\商管院\\BusinessSchool-Web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:/\\u4E2A\\u4EBA\\u6210\\u957F\\u7ECF\\u5386/\\u9510\\u540D\\u79D1\\u6280/\\u4EA7\\u54C1\\u5F00\\u53D1/\\u5546\\u7BA1\\u9662/BusinessSchool-Web/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nvar _typeof2 = _interopRequireDefault(require(\"D:/\\u4E2A\\u4EBA\\u6210\\u957F\\u7ECF\\u5386/\\u9510\\u540D\\u79D1\\u6280/\\u4EA7\\u54C1\\u5F00\\u53D1/\\u5546\\u7BA1\\u9662/BusinessSchool-Web/node_modules/@babel/runtime/helpers/typeof\"));\n\nrequire(\"core-js/modules/es6.function.name\");\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  name: '',\n  data: function data() {\n    return {\n      schoolId: 0,\n      skFirmDialog: false,\n      // 上课企业 Dialog\n      skFirmSearch: '',\n      // 上课企业 搜索内容\n      courseDialog: false,\n      // 添加课程 Dialog\n      courseSearch: '',\n      // 添加课程 搜索内容\n      examDialog: false,\n      // 添加考试 Dialog\n      examSearch: '',\n      // 添加考试 搜索内容\n      medalDialog: false,\n      // 添加勋章 Dialog\n      medalSearch: '',\n      // 添加勋章 搜索内容\n      firmJsonData: [],\n      // 企业\n      medalJsonData: [],\n      // 勋章\n      courseJsonData: [],\n      // 课程\n      examJsonData: [],\n      // 考试\n      studentJsonData: [],\n      clickMajor: '',\n      clickClasses: '',\n      studentInfoJsonData: [],\n      schoolSelectorJsonData: [],\n      insertObj: false,\n      formLabelWidth: '120px',\n      defaultProps: {\n        children: 'classinfo',\n        label: 'classname'\n      },\n      firmCheck: [],\n      courseCheck: [],\n      examCheck: [],\n      medalCheck: [],\n      stduentCheck: [],\n      teachingPlanForm: {\n        attendFirm: [],\n        // 上课企业\n        teachingPlan: '',\n        // 请输入教学计划主题\n        teachingPlanCourse: [],\n        // 教学计划内容 - 课程\n        teachingPlanExam: [],\n        // 教学计划内容 - 考试\n        teachingPlanInfo: '',\n        // 教学计划说明\n        imageUrl: '',\n        // 教学计划封面\n        teachingPlanSchool: '',\n        // 学校\n        teachingPlanObj: [],\n        // 上课对象\n        teachingPlanMedal: [],\n        // 认证勋章\n        teachingPlanComplete: '',\n        // 完成度\n        teachingPlanIntegral: '',\n        // 积分\n        teachingPlanGrade: '' // 成绩\n\n      },\n      rules: {\n        attendFirm: [{\n          required: true,\n          message: '请选择上课企业',\n          trigger: 'change'\n        }],\n        teachingPlan: [{\n          required: true,\n          message: '请输入教学计划主题',\n          trigger: 'blur'\n        }],\n        teachingPlanDesc: [{\n          required: true,\n          message: '请选择教学计划内容',\n          trigger: 'change'\n        }],\n        teachingPlanSchool: [{\n          required: true,\n          message: '请选择学校',\n          trigger: 'change'\n        }],\n        teachingPlanObj: [{\n          required: true,\n          message: '请选择上课对象',\n          trigger: 'change'\n        }]\n      }\n    };\n  },\n  created: function created() {\n    this.schoolId = this.$store.getters.schoolId;\n    this.requestSchoolSelectorJsonData();\n  },\n  methods: {\n    // 获取学校列表\n    requestSchoolSelectorJsonData: function requestSchoolSelectorJsonData() {\n      var _this = this;\n\n      this.$axios.post(this.$global.sApi + '/addscuser', JSON.stringify({\n        'type': 3,\n        'current_page': 1,\n        'perpage': 9999\n      })).then(function (res) {\n        _this.schoolSelectorJsonData = res.data.data.data;\n      });\n    },\n    // 显示企业选择\n    showFirmModal: function showFirmModal() {\n      this.requestFirmJsonData();\n      this.skFirmDialog = true;\n    },\n    // 企业列表\n    requestFirmJsonData: function requestFirmJsonData() {\n      var _this2 = this;\n\n      this.$axios.post(this.$global.sApi + '/findmsg', JSON.stringify({\n        'type': 1\n      })).then(function (res) {\n        _this2.firmJsonData = res.data.data[0];\n      });\n    },\n    // 显示添加课程\n    showCourseModal: function showCourseModal() {\n      this.requestCourseJsonData();\n      this.courseDialog = true;\n    },\n    // 获取课程列表\n    requestCourseJsonData: function requestCourseJsonData() {\n      var _this3 = this;\n\n      this.$axios.post(this.$global.sApi + '/course', JSON.stringify({\n        'type': 4,\n        'current_page': 1,\n        'perpage': 9999\n      })).then(function (res) {\n        _this3.courseJsonData = res.data.data.data;\n      });\n    },\n    // 显示添加考试\n    showExamModal: function showExamModal() {\n      this.requestExamJsonData();\n      this.examDialog = true;\n    },\n    // 获取考试列表\n    requestExamJsonData: function requestExamJsonData() {\n      var _this4 = this;\n\n      this.$axios.post(this.$global.sApi + '/addtest', JSON.stringify({\n        'type': 4,\n        'current_page': 1,\n        'perpage': 9999\n      })).then(function (res) {\n        _this4.examJsonData = res.data.data.data;\n      });\n    },\n    // 显示添加对象\n    showObjModal: function showObjModal() {\n      this.requestSchoolJsonData();\n      this.requestStudentInfoJsonData();\n      this.insertObj = true;\n    },\n    // 筛选学生资料\n    requestFilterClickJsonData: function requestFilterClickJsonData() {\n      var _this5 = this;\n\n      this.$axios.post(this.$global.sApi + '/findstu', JSON.stringify({\n        'proinfoid': parseInt(this.clickMajor) | '',\n        'classinfoid': parseInt(this.clickClasses) | ''\n      })).then(function (res) {\n        // this.total = res.data.data.total\n        var json = res.data.data[0];\n        _this5.studentInfoJsonData = json;\n      });\n    },\n    // 获取学生资料列表\n    requestStudentInfoJsonData: function requestStudentInfoJsonData() {\n      var _this6 = this;\n\n      this.$axios.post(this.$global.sApi + '/liststu', JSON.stringify({\n        'classinfoid': 2,\n        'majorId': '',\n        'classesId': '',\n        'current_page': this.currentPage,\n        'perpage': this.pagesize\n      })).then(function (res) {\n        _this6.total = res.data.data.total;\n        var json = res.data.data.data;\n\n        if (json.length > 0) {\n          _this6.studentInfoJsonData = json;\n        }\n      });\n    },\n    // 获取学校数据\n    requestSchoolJsonData: function requestSchoolJsonData() {\n      var _this7 = this;\n\n      this.$axios.post(this.$global.sApi + '/navigation', JSON.stringify({\n        'scinfoid': this.schoolId\n      })).then(function (res) {\n        var json = res.data.data[0];\n\n        if (json.length > 0) {\n          _this7.studentJsonData = json;\n        }\n      });\n    },\n    // 显示添加勋章\n    showMedalModal: function showMedalModal() {\n      this.requestMedalJsonData();\n      this.medalDialog = true;\n    },\n    // 勋章列表\n    requestMedalJsonData: function requestMedalJsonData() {\n      var _this8 = this;\n\n      this.$axios.post(this.$global.sApi + '/addexz', JSON.stringify({\n        'type': 4,\n        'current_page': 1,\n        'perpage': 9999\n      })).then(function (res) {\n        _this8.medalJsonData = res.data.data.data;\n      });\n    },\n    handleClose: function handleClose(tag) {\n      this.dynamicTags.splice(this.dynamicTags.indexOf(tag), 1);\n    },\n    // 前端校验文件上传是否符合条件\n    file_info_check: function file_info_check(file) {\n      var ret = '';\n\n      if (file === undefined) {\n        ret = '';\n      } // eslint-disable-next-line camelcase\n\n\n      var max_file_size = 2 * 1024 * 1024; // eslint-disable-next-line camelcase\n\n      if (file.size > max_file_size) {\n        ret = '文件不能大于2Mb';\n      }\n\n      var typeJpg = '.jpg';\n      var typeJpeg = '.jpeg';\n      var typePng = '.png';\n\n      if (file.name.indexOf(typeJpg) === -1) {\n        ret = '文件格式要求是.jpg/.jpeg/.png';\n      } else {\n        ret = 'success';\n        return ret;\n      }\n\n      if (file.name.indexOf(typeJpeg) === -1) {\n        ret = '文件格式要求是.jpg/.jpeg/.png';\n      } else {\n        ret = 'success';\n        return ret;\n      }\n\n      if (file.name.indexOf(typePng) === -1) {\n        ret = '文件格式要求是.jpg/.jpeg/.png';\n      } else {\n        ret = 'success';\n        return ret;\n      }\n\n      return ret;\n    },\n    uploadImg: function uploadImg(fileObj) {\n      var _this9 = this;\n\n      this.loading = true;\n      var fileStatus = this.file_info_check(fileObj.file);\n\n      if (fileStatus === 'success') {\n        var formData = new FormData();\n        formData.append('file', fileObj.file);\n        this.$axios.post('/upschead', formData, {\n          headers: {\n            'Content-type': 'multipart/form-data'\n          }\n        }).then(function (res) {\n          // this.registerForm.imageUrl = res\n          _this9.$message({\n            message: '提交成功',\n            type: 'success'\n          });\n\n          _this9.teachingPlanForm.imageUrl = res.data.path;\n          _this9.loading = false;\n        });\n      } else {\n        this.$message({\n          message: fileStatus,\n          type: 'error'\n        });\n      }\n    },\n    handleSelectionFirm: function handleSelectionFirm(val) {\n      this.firmCheck = val;\n    },\n    checkFirm: function checkFirm() {\n      this.teachingPlanForm.attendFirm = this.firmCheck;\n      console.log(this.teachingPlanForm.attendFirm);\n      this.skFirmDialog = false;\n    },\n    handleSelectionCourse: function handleSelectionCourse(val) {\n      this.courseCheck = val;\n    },\n    checkCourse: function checkCourse() {\n      this.teachingPlanForm.teachingPlanCourse = this.courseCheck;\n      this.courseDialog = false;\n    },\n    handleSelectionExam: function handleSelectionExam(val) {\n      this.examCheck = val;\n    },\n    checkExam: function checkExam() {\n      this.teachingPlanForm.teachingPlanExam = this.examCheck;\n      this.examDialog = false;\n    },\n    handleSelectionMedal: function handleSelectionMedal(val) {\n      this.medalCheck = val;\n    },\n    checkMedal: function checkMedal() {\n      this.teachingPlanForm.teachingPlanMedal = this.medalCheck;\n      this.medalDialog = false;\n    },\n    handleSelectionStudent: function handleSelectionStudent(val) {\n      this.stduentCheck = val;\n    },\n    checkStudent: function checkStudent() {\n      this.teachingPlanForm.teachingPlanObj = this.stduentCheck;\n      this.insertObj = false;\n    },\n    // 院校专业菜单\n    handleNodeClick: function handleNodeClick(data) {\n      if ((0, _typeof2.default)(data.classinfo) === \"object\") {\n        this.clickMajor = data.id;\n      } else {\n        this.clickClasses = data.id;\n        this.requestFilterClickJsonData();\n      }\n    },\n    // 树形菜单\n    renderContent: function renderContent(h, _ref) {\n      var node = _ref.node,\n          data = _ref.data,\n          store = _ref.store;\n      var addElement = arguments[0];\n      return addElement('span', {\n        class: \"folder-box\"\n      }, [addElement('i', {\n        class: \"folder-icon\"\n      }), addElement('span', \"    \"), addElement('span', arguments[1].node.label)]);\n    },\n    // 提交\n    submitTeachingPlan: function submitTeachingPlan(formName) {\n      var _this10 = this;\n\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          if (_this10.courseCheck.length > 0) {\n            _this10.insertTeachingPlan(formName);\n          } else {\n            _this10.$message({\n              message: '请选择教学计划内容',\n              type: 'warning'\n            });\n          }\n        } else {\n          return false;\n        }\n      });\n    },\n    // 添加教学计划\n    insertTeachingPlan: function insertTeachingPlan(formName) {\n      var _this11 = this;\n\n      var firmList = '';\n      this.teachingPlanForm.attendFirm.forEach(function (element) {\n        firmList += element.id + ',';\n      });\n      var courseList = '';\n      this.teachingPlanForm.teachingPlanCourse.forEach(function (element) {\n        courseList += element.id + ',';\n      });\n      var examList = '';\n      this.teachingPlanForm.teachingPlanExam.forEach(function (element) {\n        examList += element.id + ',';\n      });\n      var medalList = '';\n      this.teachingPlanForm.teachingPlanMedal.forEach(function (element) {\n        medalList += element.id + ',';\n      });\n      this.$axios.post(this.$global.sApi + '/addevent', JSON.stringify({\n        // scinfoid::企业列表, 以逗号分隔                        teachingPlanForm: {\n        // major:主题                                attendFirm: [], // 上课企业\n        // course:课程列表ID 以逗号分隔               teachingPlan: '',  // 请输入教学计划主题\n        // test:考试列表id 以逗号分隔                 teachingPlanExam: [],  // 教学计划内容\n        // brief:简介 (空就以暂无代替)                teachingPlanInfo: '', // 教学计划说明\n        // header:封面图片 (空就以暂无代替)           imageUrl: '', // 教学计划封面\n        // schoolid:学校ID                           teachingPlanSchool: '', // 学校\n        // medal:认证勋章id 以逗号分隔                teachingPlanObj: '', // 上课对象\n        // points 积分完成率                         teachingPlanMedal: [], // 认证勋章\n        // res 成绩完成率                            teachingPlanComplete: '', // 完成度\n        // class 课程完成率                          teachingPlanIntegral: '', // 积分\n        // classid:班级id                           teachingPlanGrade: '' // 成绩\n        // classobj: 学生id 以逗号分隔               teachingPlanCourse: [],  // 教学计划内容\n        'scinfoid': firmList.substring(0, firmList.length - 1),\n        'major': this.teachingPlanForm.teachingPlan,\n        'course': courseList.substring(0, courseList.length - 1),\n        'test': examList.substring(0, examList.length - 1),\n        'brief': this.teachingPlanForm.teachingPlanInfo == '' ? '暂无' : this.teachingPlanForm.teachingPlanInfo,\n        'header': this.teachingPlanForm.imageUrl,\n        'schoolid': parseInt(this.teachingPlanForm.teachingPlanSchool),\n        'medal': medalList.substring(0, medalList.length - 1),\n        'points': this.teachingPlanForm.teachingPlanIntegral,\n        'res': this.teachingPlanForm.teachingPlanGrade,\n        'class': this.teachingPlanForm.teachingPlanComplete,\n        'classid': parseInt(this.clickClasses),\n        'classobj': this.teachingPlanForm.teachingPlan\n      })).then(function (res) {\n        _this11.$message({\n          message: '制定成功',\n          type: 'success'\n        });\n\n        _this11.$refs[formName].resetFields();\n\n        _this11.teachingPlanForm = {};\n        _this11.firmCheck = [];\n        _this11.courseCheck = [];\n        _this11.examCheck = [];\n        _this11.medalCheck = [];\n        _this11.stduentCheck = [];\n        _this11.clickClasses = '';\n        _this11.clickMajor = '';\n      });\n    }\n  }\n};\nexports.default = _default;",null]}